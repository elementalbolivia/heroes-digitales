!function(){"use strict";function e(e,t,s,n,i,a,r){function o(){s.getQuestions(r.checkpointId).then(function(e){e.success?f.questions=e.questions:alert(e.msg)},function(e){})}function u(){s.getCheckpoint(r.id,r.checkpointId).then(function(e){e.success?f.checkpoint=e.checkpoint:alert(e.msg)},function(e){})}function c(){if(0==f.checkpointQuestions.length)return f.isUploaded.state=!0,void(f.isUploaded.msg="Debes crear almenos una pregunta");f.isUploaded.isLoading=!0,f.isUploaded.state=!1,s.createQuestions(r.checkpointId,{questions:f.checkpointQuestions}).then(function(e){e.success?(f.getQuestions(),f.checkpointQuestions=[]):(f.isUploaded.isLoading=!1,f.isUploaded.state=!0,f.isUploaded.msg=e.msg)},function(e){f.isUploaded.isLoading=!1})}function d(){f.checkpointQuestions.push({id:Date.now(),type:{id:0,label:"Ninguno"},question:""})}function l(e){for(var t=0,s=0;s<f.checkpointQuestions.length;s++)if(f.checkpointQuestions[s].id==e){t=s;break}f.checkpointQuestions.splice(t,1)}function g(e){i.open(e)}function m(e,t){"BEGIN"==t?(f.newStage.beginDate.date=e,f.newStage.beginDate.formatted=moment(e).locale(f.newStage.locale).format("L")):(f.newStage.endDate.date=e,f.newStage.endDate.formatted=moment(e).locale(f.newStage.locale).format("L"))}var f=this;f.checkpoint={},f.questions=[],f.checkpointQuestions=[],f.isUploaded={state:!1,msg:"",isLoading:!1},f.getCheckpoint=u,f.getQuestions=o,f.addQuestion=d,f.deleteQuestion=l,f.createQuestions=c,f.openDatePicker=g,f.datePickerCallback=m,f.getQuestions(),f.getCheckpoint()}angular.module("heroesDigitalesApp").controller("CheckpointAdminCtrl",["User","Auth","Checkpoint","LxNotificationService","LxDatePickerService","$state","$stateParams",e])}(),function(){"use strict";function e(e,t,s,n,i,a){function r(){s.getStages().then(function(e){e.success?d.stages=e.stages:alert(e.msg)},function(e){})}function o(e){i.open(e)}function u(e,t){"BEGIN"==t?(d.newStage.beginDate.date=e,d.newStage.beginDate.formatted=moment(e).locale(d.newStage.locale).format("L")):(d.newStage.endDate.date=e,d.newStage.endDate.formatted=moment(e).locale(d.newStage.locale).format("L"))}function c(){d.isUploaded.isLoading=!0,d.isUploaded.state=!1;var e={name:d.newStage.name,desc:d.newStage.desc,beginDate:d.newStage.beginDate.formatted.split("/").reverse().join("-"),endDate:d.newStage.endDate.formatted.split("/").reverse().join("-")};s.createStage(e).then(function(e){e.success?a.go("admin.stage",{id:e.stageId}):(d.isUploaded.isLoading=!1,d.isUploaded.state=!0,d.isUploaded.msg=e.msg)},function(e){})}var d=this;d.stages=[],d.newStage={name:"",desc:"",locale:"es",minDate:new Date((new Date).getFullYear(),(new Date).getMonth()-2,(new Date).getDate()),maxDate:new Date((new Date).getFullYear(),(new Date).getMonth()+6,(new Date).getDate()),beginDate:{id:"_begin",date:new Date,formatted:moment().locale("es").format("L")},endDate:{id:"_end",date:new Date,formatted:moment().locale("es").format("L")}},d.isUploaded={state:!1,msg:"",isLoading:!1},d.getStages=r,d.openDatePicker=o,d.datePickerCallback=u,d.createStage=c,d.getStages()}angular.module("heroesDigitalesApp").controller("CreateStageAdminCtrl",["User","Auth","Stage","LxNotificationService","LxDatePickerService","$state",e])}(),function(){"use strict";function e(e,t,s,n,i){function a(){s.getStages().then(function(e){e.success?r.stages=e.stages:alert(e.msg)},function(e){})}var r=this;r.userCreds=t.getSession(),r.userData={},r.stages=[],r.getStages=a,r.getStages()}angular.module("heroesDigitalesApp").controller("DashboardAdminCtrl",["User","Auth","Stage","LxNotificationService","$state",e])}(),function(){"use strict";function e(e,t,s,n,i,a){function r(){n.getExperts().then(function(e){e.success?c.experts=e.experts:alert(e.msg)},function(e){})}function o(e,t){var s=t?"Esta seguro que desea aprobarlo para ser juez/experto?":"Esta seguro que desea rechazarlo para ser juez/experto?";a.confirm(s,"",{cancel:"Cancelar",ok:"Si, deseo hacerlo"},function(s){if(s){var n={id:e,accept:t};i.confirmRequest(n).then(function(e){e.success?(c.getExperts(),c.getJudges(),a.success("La acción fue realizada con éxito")):a.warn("Hubo un error al realizar la acción")},function(e){a.error("Hubo un error al realizar la acción")})}})}function u(){c.assignTeams.state=!0,n.assignRandomTeams().then(function(e){c.assignTeams.state=!1,e.success?a.success(e.msg):a.warning(e.msg)},function(e){c.assignTeams.state=!1,a.error()})}var c=this;c.userCreds=t.getSession(),c.userData={},c.experts=[],c.getExperts=r,c.processRequest=o,c.assignRandom=u,c.assignTeams={state:!1},c.getExperts()}angular.module("heroesDigitalesApp").controller("ExpertAdminCtrl",["User","Auth","Team","Expert","Request","LxNotificationService",e])}(),function(){"use strict";function e(e){function t(){e.logout()}var s=this;s.userCreds=e.getSession(),s.logout=t}angular.module("heroesDigitalesApp").controller("HeaderAdminCtrl",["Auth",e])}(),function(){"use strict";function e(e,t,s,n,i,a){function r(){n.getJudges().then(function(e){e.success?u.judges=e.judges:alert(e.msg)},function(e){})}function o(e,t){var s=t?"Esta seguro que desea aprobarlo para ser juez/experto?":"Esta seguro que desea rechazarlo para ser juez/experto?";a.confirm(s,"",{cancel:"Cancelar",ok:"Si, deseo hacerlo"},function(s){if(s){var n={id:e,accept:t};i.confirmRequest(n).then(function(e){e.success?(u.getExperts(),u.getJudges(),a.success("La acción fue realizada con éxito")):a.warn("Hubo un error al realizar la acción")},function(e){a.error("Hubo un error al realizar la acción")})}})}var u=this;u.userCreds=t.getSession(),u.userData={},u.judges=[],u.getJudges=r,u.processRequest=o,u.getJudges()}angular.module("heroesDigitalesApp").controller("JudgeAdminCtrl",["User","Auth","Team","Judge","Request","LxNotificationService",e])}(),function(){"use strict";function e(e,t,s){function n(){i.loginAdminState.isNotLogged=!1,i.loginAdminState.isLoading=!0,s.login(i.creds).then(function(t){t.success?(s.setSession(t.uid,t.rid,t.username,t.token,t.min_fields,t.has_team,t.team_id,t.is_leader),e.go(t.path)):(i.loginAdminState.isNotLogged=!0,i.loginAdminState.isLoading=!1,i.loginAdminState.msg=t.msg)},function(e){})}var i=this;i.creds={email:"",password:""},i.loginAdminState={isNotLogged:!1,msg:"",isLoading:!1},i.loginAdmin=n}angular.module("heroesDigitalesApp").controller("LoginAdminCtrl",["$state","$timeout","Auth",e])}(),function(){"use strict";function e(e,t,s,n,i,a,r,o){function u(){a.getMentorsAdmin(l.currentPage).then(function(e){if(e.success){l.isLoading=!1,l.mentors=e.mentors,l.total=e.pages;for(var t=0;t<e.pages;t++)l.pagination.push(t+1)}else alert(e.msg)},function(e){alert("Hubo un error al obtener a los mentores")})}function c(e,t){var n=t?"¿Está seguro de aprobar al estudiante?":"¿Está seguro de eliminar al estudiante?",i=t?"El estudiante podrá acceder a su sesión":"El estudiante ya no podrá iniciar sesión";o.confirm(n,i,{cancel:"Cancelar",ok:"Si, deseo hacerlo"},function(n){n&&s.confirmUser({uid:e,action:t}).then(function(s){if(s.success){o.success(s.msg);for(var n=0;n<l.mentors.length;n++)if(l.mentors[n].id==e){l.mentors[n].is_active=t;break}}else o.warning("No se actualizo al usuario, intente nuevamente")},function(e){o.error("Hubo un error al actualizar al usuario")})})}function d(){a.excelReport().then(function(e){e.succes?o.success(e.msg):o.warning(e.msg)},function(e){o.error("Hubo un error al descargar el reporte, revise su conexión a internet")})}var l=this;l.userCreds=n.getSession(),l.url=t+"mentors/report/excel?token="+l.userCreds.token,l.userData={},l.mentors=[],l.isLoading=!0,l.getMentors=u,l.approve=c,l.total=0,l.pagination=[],l.currentPage=e.num,l.downloadReport=d,l.filters={withTeam:"ALL"},l.getMentors()}angular.module("heroesDigitalesApp").controller("MentorAdminCtrl",["$stateParams","AUTH_URL","User","Auth","Team","Mentor","Request","LxNotificationService",e])}(),function(){"use strict";function e(e,t,s,n,i,a,r){function o(e){"student"==e?(b.typeParams.title="Estudiante",b.dataRegister.type="student"):"mentor"==e?(b.typeParams.title="Mentor",b.dataRegister.type="mentor"):"judge"==e?(b.typeParams.title="Juez",b.dataRegister.type="judge"):"expert"==e&&(b.typeParams.title="Experto",b.dataRegister.type="expert")}function u(){s.getCities().then(function(e){e.success&&(b.cities=e.cities)},function(e){})}function c(){i.getGenres().then(function(e){e.success&&(b.genres=e.genres)},function(e){})}function d(){n.getShirts().then(function(e){e.success&&(b.shirts=e.shirts)},function(e){})}function l(){for(var e=1960;e<=2008;e++)b.dates.years.push(e)}function g(e,t){return e==t||(b.isNotRegistered.state=!0,b.isNotRegistered.msg="Su contraseña no coincide, escribala nuevamente",!1)}function m(){return b.isNotRegistered.state=!1,p(b.dataRegister.birthDate.day,b.dataRegister.birthDate.month,b.dataRegister.birthDate.year)?h(b.dataRegister.cellphone)?void(g(b.dataRegister.password,b.dataRegister.retype)&&(b.isNotRegistered.state=!1,b.isNotRegistered.isLoading=!0,a.register(b.dataRegister).then(function(e){e.success?(r.success("El registro fue llenado con éxito"),b.isNotRegistered.isLoading=!1,b.dataRegister={type:b.typeReg,typeRegister:b.typeReg,from:"admin",names:"",lastnames:"",birthDate:{day:"Día",month:"Mes",year:"Año"},cellphone:"",cityId:1,zone:"",genreId:1,school:"",email:"",shirtId:1,socialNetwork:"",password:"",retype:"",org:"",job:"",profession:"",cv:{}}):(b.isNotRegistered.state=!0,b.isNotRegistered.isLoading=!1,b.isNotRegistered.msg=e.msg)},function(e){b.isNotRegistered.state=!0,b.isNotRegistered.isLoading=!1,b.isNotRegistered.msg="Hubo un error al realizar su registro, revise su conexión a internet e inténtelo nuevamente"}))):(b.isNotRegistered.state=!0,void(b.isNotRegistered.msg="Debe introducir un número de teléfono")):(b.isNotRegistered.state=!0,void(b.isNotRegistered.msg="Debe introducir una fecha de nacimiento"))}function f(e){return void 0==e||""==e||-1==e.search(/linkedin/i)&&-1==e.search(/facebook/i)?(b.isNotRegistered.state=!0,b.isNotRegistered.msg="Debes enlazar tu cuenta de Facebook o LinkedIn",!1):(b.isNotRegistered.state=!1,!0)}function p(e,t,s){return!!(Number(e)&&Number(t)&&Number(s))}function h(e){return!(!Number.isInteger(Number(e))||8!=e.length||"6"!=e.charAt(0)&&"7"!=e.charAt(0))}function v(){$timeout(function(){$state.go("home")},1500)}var b=this;b.getCities=u,b.getGenres=c,b.getShirts=d,b.generateYears=l,b.sendRegistration=m,b.validateSocialNetwork=f,b.returnHome=v,b.setRegProps=o;var g=g,p=p,h=h;b.typeReg="student",b.typeParams={},b.isNotRegistered={state:!1,msg:"",isLoading:!1},b.dataRegister={type:b.typeReg,typeRegister:b.typeReg,from:"admin",names:"",lastnames:"",birthDate:{day:"Día",month:"Mes",year:"Año"},cellphone:"",cityId:1,zone:"",genreId:1,school:"",email:"",shirtId:1,socialNetwork:"",password:"",retype:"",org:"",job:"",profession:""},b.cities=[],b.schools=[],b.shirts=[],b.genres=[],b.dates={days:["Día","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],months:["Mes","01","02","03","04","05","06","07","08","09","10","11","12"],years:["Año"]},o(b.typeReg),u(),d(),c(),l()}angular.module("heroesDigitalesApp").controller("RegisterAdminCtrl",["User","Auth","City","Shirt","Genre","Register","LxNotificationService",e])}(),function(){"use strict";function e(e,t,s,n,i,a,r,o){function u(){n.getCheckpoints(o.id).then(function(e){e.success?m.checkpoints=e.checkpoints:alert(e.msg)},function(e){})}function c(){s.getStage(o.id).then(function(e){e.success&&(m.stage=e.stage)},function(e){})}function d(e){a.open(e)}function l(e,t){"EVAL"==t&&(m.newCheckpoint.evalDate.date=e,m.newCheckpoint.evalDate.formatted=moment(e).locale(m.newCheckpoint.locale).format("L"))}function g(){m.isUploaded.isLoading=!0,m.isUploaded.state=!1;var e={stageId:o.id,name:m.newCheckpoint.name,evalDate:m.newCheckpoint.evalDate.formatted.split("/").reverse().join("-")};n.createCheckpoint(e).then(function(e){e.success?r.go("admin.stage.checkpoint",{stageId:o.id,checkpointId:e.checkId}):(m.isUploaded.isLoading=!1,m.isUploaded.state=!0,m.isUploaded.msg=e.msg)},function(e){})}var m=this;m.checkpoints=[],m.stage={},m.isUploaded={state:!1,msg:"",isLoading:!1},m.newCheckpoint={name:"",locale:"es",minDate:new Date((new Date).getFullYear(),(new Date).getMonth()-6,(new Date).getDate()),maxDate:new Date((new Date).getFullYear(),(new Date).getMonth()+6,(new Date).getDate()),evalDate:{id:"_eval",date:new Date,formatted:moment().locale("es").format("L")}},m.getCheckpoints=u,m.getStage=c,m.openDatePicker=d,m.datePickerCallback=l,m.createCheckpoint=g,m.getCheckpoints(),m.getStage()}angular.module("heroesDigitalesApp").controller("StageAdminCtrl",["User","Auth","Stage","Checkpoint","LxNotificationService","LxDatePickerService","$state","$stateParams",e])}(),function(){"use strict";function e(e,t,s,n,i,a,r,o){function u(){a.getStudentsAdmin(f.currentPage).then(function(e){if(e.success){f.isLoading=!1,f.students=e.students,f.total=e.pages;for(var t=0;t<e.pages;t++)f.pagination.push(t+1)}else alert(e.msg)},function(e){alert("Hubo un error al obtener los datos de los estudiantes")})}function c(e){a.getStudentParents(e).then(function(e){e.success?(f.studentParent.names=e.student_names,f.studentParent.lastnames=e.student_lastnames,f.studentParent.student_id=e.student_id,"NONE"==e.code?(f.studentParent.isAny=!1,f.studentParent.msg=e.msg):(f.studentParent.isAny=!0,f.studentParent.parents=e.parents,f.studentParentSignature.id=e.parents.id)):o.warning("Intente cargar nuevamente los datos del usuario")},function(e){o.error("Hubo un error al obtener los datos del usuario")})}function d(e,t){if("TEAM"==e)return void(f.filters.withTeam=t);var s=f.filters[e].indexOf(t);-1==s?f.filters[e].push(t):f.filters[e].splice(s,1)}function l(e,t){var n=t?"¿Está seguro de aprobar al estudiante?":"¿Está seguro de eliminar al estudiante?",i=t?"El estudiante podrá acceder a su sesión":"El estudiante ya no podrá iniciar sesión";o.confirm(n,i,{cancel:"Cancelar",ok:"Si, deseo hacerlo"},function(n){n&&s.confirmUser({uid:e,action:t}).then(function(s){if(s.success){o.success(s.msg);for(var n=0;n<f.students.length;n++)if(f.students[n].id==e){f.students[n].is_active=t;break}}else o.warning("No se actualizo al usuario, intente nuevamente")},function(e){o.error("Hubo un error al actualizar al usuario")})})}function g(){if(""==f.studentParentSignature.signature.trim())return f.studentParent.isSigned.state=!0,void(f.studentParent.isSigned.msg="Debe llenar la firma del padre/tutor");a.authParent(f.studentParentSignature).then(function(e){if(e.success){o.success(e.msg);for(var t=0;t<f.students.length;t++)if(f.students[t].id==f.studentParent.student_id){f.students[t].student.authorization={active:!0,signature:f.studentParentSignature.signature};break}}else o.warning(e.msg)},function(e){o.error("Hubo un error al actualizar al usuario")})}function m(){a.excelReport().then(function(e){e.succes?o.success(e.msg):o.warning(e.msg)},function(e){o.error("Hubo un error al descargar el reporte, revise su conexión a internet")})}var f=this;f.userCreds=n.getSession(),f.url=t+"students/report/excel?token="+f.userCreds.token,f.userData={},f.students=[],f.isLoading=!0,f.studentParent={names:"",lastnames:"",isAny:!1,msg:"",parents:{},isSigned:{state:!1,msg:""}},f.studentParentSignature={id:0,signature:""},f.filters={cities:["La Paz","El Alto"],gender:["Femenino","Masculino"],withTeam:"ALL"},f.total=0,f.pagination=[],f.currentPage=e.num,f.getStudents=u,f.updateFilter=d,f.approve=l,f.getStudent=c,f.confirmParent=g,f.downloadReport=m,f.getStudents()}angular.module("heroesDigitalesApp").controller("StudentAdminCtrl",["$stateParams","AUTH_URL","User","Auth","Team","Student","Request","LxNotificationService",e])}(),function(){"use strict";function e(e,t,s,n,i,a,r,o){function u(){a.getTeamsAdmin().then(function(e){e.success?(v.isLoading=!1,v.teams.teams=e.teams,g(e.teams)):o.warning(e.msg)},function(e){o.error(e)})}function c(e){o.confirm("¿Está seguro de borrar al equipo?","Todos los miembros del equipo serán dados de baja del equipo, y este no será visible",{cancel:"Cancelar",ok:"Si, deseo hacerlo"},function(t){t&&a.deleteTeam(e).then(function(t){if(t.success){for(var s=0;s<v.teams.length;s++)if(v.teams[s].id==e)return v.teams.splice(s,1),void o.success(t.msg)}else o.warning(t.msg)},function(e){o.error(e)})})}function d(e,t){l();var s=v.filters[e].indexOf(t);-1==s?v.filters[e].push(t):v.filters[e].splice(s,1)}function l(){v.teams.update="change:"+Date.now()}function g(e){for(var t={mentorsEA:0,mentorsLP:0,studentsEA:0,studentsLP:0,teamsLP:0,teamsEA:0,studentsFem:0,studentsMas:0,mentorsFem:0,mentorsMas:0},s=0;s<e.length;s++){"La Paz"==e[s].city.nombre?t.teamsLP+=1:t.teamsEA+=1;for(var n=e[s].members.students,i=e[s].members.mentors,a=0;a<n.length;a++)"La Paz"==n[a].city?t.studentsLP+=1:t.studentsEA+=1,"Masculino"==n[a].gender?t.studentsMas+=1:t.studentsFem+=1;for(var a=0;a<i.length;a++)"La Paz"==i[a].city?t.mentorsLP+=1:t.mentorsEA+=1,"Masculino"==i[a].gender?t.mentorsMas+=1:t.mentorsFem+=1}v.counters=t,v.chart.data={teams:[t.teamsLP+t.teamsEA,t.teamsLP,t.teamsEA],students:[t.studentsLP,t.studentsEA,t.studentsFem,t.studentsMas],mentors:[t.mentorsLP,t.mentorsEA,t.mentorsFem,t.mentorsMas]}}function m(){a.excelReport(v.filters.cities,v.filters.divisions,v.teamFilter).then(function(e){e.succes?o.success(e.msg):o.warning(e.msg)},function(e){o.error("Hubo un error al descargar el reporte, revise su conexión a internet")})}function f(){r.getExperts().then(function(e){e.success?v.experts=e.experts:o.warning(e.msg)},function(e){o.error("Hubo un error en el servidor")})}function p(e,t){v.assignExpert.team={id:e,name:t}}function h(){var e=v.assignExpert;if(e.action.isLoading=!0,null==e.expert.id)return e.action.msg="Debes seleccionar a un experto",e.action.state=!0,void(e.action.isLoading=!1);e.action.state=!1;var t={teamId:e.team.id,expertId:e.expert.id};r.assignExpertToTeam(t).then(function(t){e.action.isLoading=!1,t.success?(v.assignExpert={team:{id:null,name:""},expert:{id:null},action:{isLoading:!1,msg:"",state:!1}},$("#selectExpert").modal("hide"),o.success(t.msg)):(e.action.state=!0,e.action.msg=t.msg)},function(t){e.action.isLoading=!1,e.action.state=!0,e.action.msg="Hubo un error en el servidor"})}var v=this;v.userCreds=i.getSession(),v.userData={},v.url=t+"teams/report/excel?token="+v.userCreds.token,v.teams={teams:[],update:"none"},v.counters={mentorsEA:0,mentorsLP:0,studentsEA:0,studentsLP:0,teamsLP:0,teamsEA:0,studentsFem:0,studentsMas:0,mentorsFem:0,mentorsMas:0},v.chart={labels:{teams:["Total equipos","Equipos La Paz","Equipos El Alto"],students:["Estudiantes La Paz","Estudiantes El Alto","Estudiantes Mujeres","Estudiantes Hombres"],mentors:["Mentores La Paz","Mentores El Alto","Mentores Mujeres","Mentores Hombres"]},data:{teams:Array(3).fill(0),students:Array(4).fill(0),mentors:Array(4).fill(0)}},v.filters={cities:["La Paz","El Alto","Pando","Cochabamba"],divisions:["Junior (de 10 a 14 años)","Senior (de 15 a 18 años)"],categories:["Educación"],teamThat:{requestMembers:!0,requestMentors:!0}},v.experts=[],v.isLoading=!0,v.assignExpert={team:{id:null,name:""},expert:{id:null},action:{isLoading:!1,msg:"",state:!1}};var g=g,l=l;v.updateFilter=d,v.getTeams=u,v.downloadReport=m,v.deleteTeam=c,v.getExperts=f,v.selectTeam=p,v.assignExpertToTeam=h,e.$watch("vm.teams.update",function(e,t){try{if(void 0===v.filtered)throw"NO FILTERED ARRAY PROVIDED";s(function(){g(v.filtered)},0)}catch(e){}}),v.getTeams(),v.getExperts()}angular.module("heroesDigitalesApp").controller("TeamAdminCtrl",["$scope","AUTH_URL","$timeout","User","Auth","Team","Expert","LxNotificationService",e])}(),function(){"use strict";function e(e,t,s,n,i,a){function r(e){t.getInfo(e).then(function(e){e.success&&(d.mentorData=e.user,d.isMemberInvited=d.hasInvited())},function(e){alert("Hubo un error")})}function o(t){d.authParams.hasTeam?(d.uploadInvitation.isLoading=!0,i.inviteToTeam({uid:t,teamId:d.authParams.teamId,role:d.mentorData.role_id}).then(function(t){t.success?(a.alert("Felicidades","La invitación fue enviada con éxito","OK",function(e){}),d.getMentorData(e.id),d.isMemberInvited=d.hasInvited()):a.warning(t.msg)},function(e){a.error("Hubo un error en el servidor")}),d.uploadInvitation.isLoading=!1):a.alert("Debes crear un equipo o unirte a uno","","Esta bien",function(e){})}function u(){for(var e=d.mentorData.invitations,t=0;t<e.length;t++)if(e[t].team_id==d.authParams.teamId)return d.mentorData.invitationId=e[t].invitation_id,!0;return!1}function c(){i.confirmInvitationFromTeam({invitationId:d.mentorData.invitationId,accept:!1}).then(function(t){t.success?(r(e.id),a.success("La invitación fue cancelada")):a.warning("Hubo un error al cancelar la invitación")},function(e){a.error("Hubo un error en el servidor, revise su conexión a internet")})}var d=this;d.mentorData={names:"",lastnames:"",img:"",email:"",birthDate:"",genre:"",school:"",city:"",zone:"",bio:""},d.uploadInvitation={isLoading:!1},d.isMemberInvited=!1,d.authParams=n.getSession(),d.getMentorData=r,d.inviteToTeam=o,d.hasInvited=u,d.cancelInvitation=c,r(e.id)}angular.module("heroesDigitalesApp").controller("MentorProfileCtrl",["$stateParams","User","Mentor","Auth","Team","LxNotificationService",e])}(),function(){"use strict";function e(e,t,s){function n(){a.isLoading=!0,s.getMentors(a.currentPage,{city:a.filters.cities,withTeam:a.filters.withTeam,mentorName:a.filters.mentorName}).then(function(e){if(e.success){a.isLoading=!1,a.mentors=e.mentors,a.total=e.pages,a.pagination=[];for(var t=0;t<e.pages;t++)a.pagination.push(t+1)}else a.isLoading=!1,alert(e.msg)},function(e){a.isLoading=!1,alert("Hubo un error al obtener a los mentores, inténtelo nuevmante")})}function i(e,t){if("TEXT"==t)return void n();if("withTeam"==e)return a.filters.withTeam=t,void n();var s=a.filters[e].indexOf(t);-1==s?a.filters[e].push(t):a.filters[e].splice(s,1),n()}var a=this;a.mentors=[],a.filters={cities:e.cities.split(","),withTeam:"true"===e.wteam,mentorName:e.mentor},a.total=0,a.pagination=[],a.currentPage=e.num,a.isLoading=!0,a.getMentors=n,a.updateFilter=i,n()}angular.module("heroesDigitalesApp").controller("MentorsCtrl",["$stateParams","User","Mentor",e])}(),function(){function e(e,t,s,n,i){function a(){var t={rid:e.id,token:e.token,signature:o.signature.name};i.parentAuth(t).then(function(e){$("#parentAuth").modal("show"),e.success?(o.sended.title="Felicitaciones",o.sended.msg=e.msg,o.sended.success=!0):(o.sended.title="Error en la verificación",o.sended.msg=e.msg,o.sended.success=!1)},function(e){n.error("Hubo un error al procesar la autorización, revise su conexión a internet")})}function r(e){e&&s(function(){t.go("home")},500)}var o=this;o.signature={name:""},o.sended={isLoading:!1,msg:"",title:"",success:!1},o.accept=a,o.redirect=r}angular.module("heroesDigitalesApp").controller("AuthParentsCtrl",["$stateParams","$state","$timeout","LxNotificationService","Student",e])}(),function(){"use strict";function e(e,t,s,n,i){function a(){r.isSubmited.state=!0,r.isSubmited.success.state=!1,n.confirmEmail(r.authParams).then(function(e){e.success?(e.already_verif&&t.go(e.path),i.setSession(e.uid,e.rid,e.username,e.token),t.go(e.path)):(r.isSubmited.success.msg=e.msg,r.isSubmited.success.state=!0,r.isSubmited.state=!1)},function(e){alert("Problema con el servidor, revise su conexión a internet")})}var r=this;r.authParams={uid:e.uid,token:e.token,email:e.email,password:""},r.isSubmited={state:!1,success:{state:!1,msg:""}},r.confirmRoute=a}angular.module("heroesDigitalesApp").controller("EmailConfirmationCtrl",["$stateParams","$state","$timeout","User","Auth",e])}(),function(){"use strict";function e(e,t,s,n){function i(){a.isSubmited.state=!1,a.isSubmited.isLoading=!0,s.sendVerifEmail(a.passwordParams).then(function(t){t.success?e.go("home.success-email-verif"):(a.isSubmited.state=!0,a.isSubmited.isLoading=!1,a.isSubmited.msg=t.msg)},function(e){alert("Hubo un error en el servidor")})}var a=this;a.passwordParams={password:""},a.isSubmited={state:!1,msg:"",isLoading:!1},a.sendEmail=i}angular.module("heroesDigitalesApp").controller("ForgotPasswordCtrl",["$state","$timeout","User","Auth",e])}(),function(){function e(e){function t(){e.getStages().then(function(e){e.success?s.stages=e.stages:alert(e.msg)},function(e){})}var s=this;s.getStages=t,s.organizers=["auspiciadores-02.png","auspiciadores-03.png"],s.sponsors=["auspiciadores-06.png","auspiciadores-05.png","auspiciadores-07.png","auspiciadores-08.jpg","auspiciadores-04.png","auspiciadores-10.png","auspiciadores-12.png","auspiciadores-13.jpg","auspiciadores-11.png"],s.getStages()}angular.module("heroesDigitalesApp").controller("HomeCtrl",["Stage",e])}(),function(){"use strict";function e(e,t,s,n,i,a){function r(){c.loginState.isNotLogged=!1,c.loginState.isLoading=!0,a.login(c.creds).then(function(n){n.success?(s(function(){4!=n.rid?t.go(n.path):e.location.href=n.path},1e3),a.setSession(n.uid,n.rid,n.username,n.token,n.min_fields,n.has_team,n.team_id,n.is_leader),$("#login").modal("hide")):(c.loginState.isNotLogged=!0,c.loginState.isLoading=!1,c.loginState.msg=n.msg)},function(e){c.loginState.isNotLogged=!0,c.loginState.isLoading=!1,c.loginState.msg="Hubo un error al iniciar sesión, revise su conexión a internet e inténtelo nuevamente"})}function o(e){$("html, body").animate({scrollTop:$(e).offset().top-100},2e3)}function u(e){t.current==t.get("home.register")?(t.go("home"),s(function(){o(e)},50)):o(e)}var c=this;c.creds={email:"",password:""},c.loginState={isNotLogged:!1,msg:"",isLoading:!1},c.login=r,c.navigate=u;var o=o}angular.module("heroesDigitalesApp").controller("LoginCtrl",["$window","$state","$timeout","$anchorScroll","$location","Auth",e])}(),function(){"use strict";function e(e,t){}angular.module("heroesDigitalesApp").controller("RegisterSuccessCtrl",["$state","$timeout",e])}(),function(){"use strict";function e(e,t,s){function n(){if(a.isSubmited.state=!1,!i(a.passwordParams.password,a.passwordParams.retype))return a.isSubmited.state=!0,void(a.isSubmited.msg="Las contraseñas no coinciden");a.isSubmited.isLoading=!0,s.resetPassword(a.passwordParams).then(function(t){t.success?e.go("home.success-reset-password"):(a.isSubmited.isLoading=!1,a.isSubmited.msg=t.msg,a.isSubmited.state=!1)},function(e){a.isSubmited.isLoading=!1,a.isSubmited.msg="Hubo un error en el servidor, inténtelo nuevamente",a.isSubmited.state=!0})}function i(e,t){return e==t}var a=this;a.passwordParams={password:"",retype:"",uid:t.id,token:t.token},a.isSubmited={state:!1,msg:"",isLoading:!1},a.resetPassword=n;var i=i}angular.module("heroesDigitalesApp").controller("ResetPasswordCtrl",["$state","$stateParams","User",e])}(),function(){"use strict";function e(e,t,s,n,i,a,r,o,u,c){function d(e){"student"==e?L.typeParams.title="Estudiante":"mentor"==e?L.typeParams.title="Mentor":"judge"==e?L.typeParams.title="Juez":"expert"==e&&(L.typeParams.title="Experto")}function l(){a.getCities().then(function(e){e.success&&(L.cities=e.cities)},function(e){})}function g(){o.getGenres().then(function(e){e.success&&(L.genres=e.genres)},function(e){})}function m(){r.getShirts().then(function(e){e.success&&(L.shirts=e.shirts)},function(e){})}function f(){for(var e=1960;e<=2008;e++)L.dates.years.push(e)}function p(e,t){return e==t||(L.isNotRegistered.state=!0,L.isNotRegistered.msg="Su contraseña no coincide, escribala nuevamente",!1)}function h(){return L.isNotRegistered.state=!1,b(L.dataRegister.birthDate.day,L.dataRegister.birthDate.month,L.dataRegister.birthDate.year)?D(L.dataRegister.cellphone)?void(p(L.dataRegister.password,L.dataRegister.retype)&&(L.isNotRegistered.state=!1,L.isNotRegistered.isLoading=!0,u.register(L.dataRegister).then(function(t){if(t.success)if("NOT_SENDED"==t.emailSended){var a={email:L.dataRegister.email,password:L.dataRegister.password};i.login(a).then(function(t){t.success?(n(function(){e.location.href=t.path},1e3),i.setSession(t.uid,t.rid,t.username,t.token,t.min_fields,t.has_team,t.team_id,t.is_leader)):c.warning(t.msg)},function(e){c.error("Hubo un error al iniciar sesión, revise su conexión a internet e inténtelo nuevamente")})}else s.go("home.success-register");else L.isNotRegistered.state=!0,L.isNotRegistered.isLoading=!1,L.isNotRegistered.msg=t.msg},function(e){L.isNotRegistered.state=!0,L.isNotRegistered.isLoading=!1,L.isNotRegistered.msg="Hubo un error al realizar su registro, revise su conexión a internet e inténtelo nuevamente"}))):(L.isNotRegistered.state=!0,void(L.isNotRegistered.msg="Debe introducir un número de teléfono")):(L.isNotRegistered.state=!0,void(L.isNotRegistered.msg="Debe introducir una fecha de nacimiento"))}function v(e){return void 0==e||""==e||-1==e.search(/linkedin/i)&&-1==e.search(/facebook/i)?(L.isNotRegistered.state=!0,L.isNotRegistered.msg="Debes enlazar tu cuenta de Facebook o LinkedIn",!1):(L.isNotRegistered.state=!1,!0)}function b(e,t,s){return!!(Number(e)&&Number(t)&&Number(s))}function D(e){return!(!Number.isInteger(Number(e))||8!=e.length||"6"!=e.charAt(0)&&"7"!=e.charAt(0))}function S(){n(function(){s.go("home")},1500)}var L=this;L.getCities=l,L.getGenres=g,L.getShirts=m,L.generateYears=f,L.sendRegistration=h,L.validateSocialNetwork=v,L.returnHome=S;var d=d,p=p,b=b,D=D;L.typeReg=t.type,L.typeParams={},L.isNotRegistered={state:!1,msg:"",isLoading:!1},L.dataRegister={type:L.typeReg,typeRegister:t.typeRegister,teamId:t.teamId,names:"",lastnames:"",birthDate:{day:"Día",month:"Mes",year:"Año"},cellphone:"",cityId:1,zone:"",genreId:1,school:"",email:"",shirtId:1,socialNetwork:"",password:"",retype:"",org:"",job:"",profession:"",cv:{}},L.cities=[],L.schools=[],L.shirts=[],L.genres=[],L.dates={days:["Día","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],months:["Mes","01","02","03","04","05","06","07","08","09","10","11","12"],years:["Año"]},d(L.typeReg),l(),m(),g(),f()}angular.module("heroesDigitalesApp").controller("UserRegisterCtrl",["$window","$stateParams","$state","$timeout","Auth","City","Shirt","Genre","Register","LxNotificationService",e])}(),function(){"use strict";function e(e,t,s,n,i,a){function r(e){t.getInfo(e).then(function(e){e.success&&(d.studentData=e.user,d.isMemberInvited=d.hasInvited())},function(e){alert("Hubo un error")})}function o(t){d.authParams.hasTeam?(d.uploadInvitation.isLoading=!0,i.inviteToTeam({uid:t,teamId:d.authParams.teamId,role:d.studentData.role_id}).then(function(t){t.success?(a.alert("Felicidades","La invitación fue enviada con éxito","OK",function(e){}),d.getStudentData(e.id),d.isMemberInvited=d.hasInvited()):a.warning(t.msg)},function(e){a.error("Hubo un error en el servidor")}),d.uploadInvitation.isLoading=!1):a.alert("Debes crear un equipo o unirte a uno","","Esta bien",function(e){})}function u(){for(var e=d.studentData.invitations,t=0;t<e.length;t++)if(e[t].team_id==d.authParams.teamId)return d.studentData.invitationId=e[t].invitation_id,!0;return!1}function c(){i.confirmInvitationFromTeam({invitationId:d.studentData.invitationId,accept:!1}).then(function(t){t.success?(r(e.id),a.success("La invitación fue cancelada")):a.warning("Hubo un error al cancelar la invitación")},function(e){a.error("Hubo un error en el servidor, revise su conexión a internet")})}var d=this;d.studentData={names:"",lastnames:"",img:"",email:"",birthDate:"",genre:"",school:"",city:"",zone:"",bio:""},d.uploadInvitation={isLoading:!1},d.isMemberInvited=!1,d.authParams=n.getSession(),d.getStudentData=r,d.inviteToTeam=o,d.hasInvited=u,d.cancelInvitation=c,r(e.id)}angular.module("heroesDigitalesApp").controller("StudentProfileCtrl",["$stateParams","User","Student","Auth","Team","LxNotificationService",e])}(),function(){"use strict";function e(e,t,s){function n(){a.isLoading=!0,s.getStudentsPage(e.num,a.filters).then(function(e){if(e.success){a.isLoading=!1,a.pagination=[],a.students=e.students,a.total=e.pages;for(var t=0;t<e.pages;t++)a.pagination.push(t+1)
}else a.isLoading=!1,alert(e.msg)},function(e){a.isLoading=!1,alert("Hubo un error al cargar los datos de los estudiantes, inténtelo nuevamente")})}function i(e,t){if("TEXT"==e)return void n();if("withTeam"==e)return a.filters.withTeam=t,void n();var s=a.filters[e].indexOf(t);-1==s?a.filters[e].push(t):a.filters[e].splice(s,1),n()}var a=this;a.students=[],a.filters={cities:e.city.split(","),gender:e.gender.split(","),withTeam:"true"==e.wteam,studentName:e.studentName},a.isLoading=!0,a.total=0,a.pagination=[],a.currentPage=e.num,a.getStudents=n,a.updateFilter=i,n()}angular.module("heroesDigitalesApp").controller("StudentsCtrl",["$stateParams","User","Student",e])}(),function(){"use strict";function e(e,t,s,n,i,a,r,o,u){function c(){r.getCities().then(function(e){e.success&&(h.cities=e.cities)},function(e){})}function d(){o.getCategories().then(function(e){e.success?h.categories=e.categories:u.warning("Hubo un error al obtener los datos de categorías, inténtelo nuevamente")},function(e){u.error("Hubo un error al obtener los datos de categorías, revise su conexión a internet")})}function l(){a.getDivisions().then(function(e){e.success?h.divisions=e.divisions:u.warning("Hubo un error al cargar los datos de divisiones,inténtelo nuevamente")},function(e){u.error("Hubo un error, revise su conexión a internet")})}function g(){n.getTeam(t.id).then(function(e){e.success?(h.teamData=e.team,h.teamData.cityId=e.team.city.id,h.teamData.categoryId=null!=e.team.category?e.team.category.id:0,h.teamData.divisionId=e.team.division.id):u.warning(e.msg)},function(e){u.error("Hubo un error al obtener los datos del equipo, revise su conexión a internet")})}function m(){0!=h.teamData.divisionId&&0!=h.teamData.cityId||(h.isSubmited.state=!0,h.isSubmited.msg="No puede dejar los campos con * en vacío"),h.isSubmited.isLoading=!0,n.editTeam(h.teamData).then(function(s){h.isSubmited.isLoading=!1,s.success?e.go("user.team-profile",{id:t.id}):(h.isSubmited.state=!0,h.isSubmited.msg=s.msg)},function(e){u.error("Hubo un error al realizar los cambios, revise su conexión a internet")})}function f(e){for(var t=0;t<h.categories.length;t++)if(h.categories[t].id==e)return void(h.categoryDesc=h.categories[t].desc);h.categoryDesc="Debe seleccionar una categoría para el equipo"}function p(e){var t="/app/images/app-arts/categorias/";switch(e){case 1:return t+"1.png";case 2:return t+"3.png";case 3:return t+"2.png";default:return}}var h=this;h.getCities=c,h.getDivisions=l,h.getCategories=d,h.getTeamInfo=g,h.editTeam=m,h.matchCategoryDesc=f,h.chooseCategoryImg=p,h.isSubmited={state:!1,msg:"",isLoading:!1},h.teamData={idLeader:t.idLeader,team_name:"",project_name:"",project_desc:"",city_d:0,category_id:0},h.cities=[],h.divisions=[],h.categories=[],c(),d(),l(),g()}angular.module("heroesDigitalesApp").controller("EditTeamProfileCtrl",["$state","$stateParams","User","Team","Auth","Division","City","Category","LxNotificationService",e])}(),function(){"use strict";function e(e,t,s,n,i,a){function r(e){n.getTeam(e).then(function(e){e.success&&(f.teamData=e.team,f.youtubeUrls={demo:{url:e.team.youtube_videos[0].youtube_url,type:"DEMO"},team:{url:e.team.youtube_videos[1].youtube_url,type:"EQUIPO"}})},function(e){alert("Hubo un error")})}function o(){if(!i.hasTeam())return void alert("Debes crear un equipo o unirte a uno")}function u(){f.uploadImg.isLoading=!0,null!=f.teamImg.newImg&&n.editTeamImg(f.teamImg).then(function(e){e.success&&(f.teamData.img=e.updated_img,f.teamImg.newImg=null),f.uploadImg.isLoading=!1},function(e){alert("Hubo un error en el servidor")})}function c(e){f.uploadRequest.isLoading=!0,n.requestJoin({idUser:f.userCreds.id,idTeam:e,role:f.userCreds.role}).then(function(e){e.success?(a.alert("FELICIDADES","Tu solicitud fue enviada con éxito, la respuesta llegará a tu correo electrónico","OK",function(e){}),f.requestHasSent()):(f.uploadRequest.msg=e.msg,f.uploadRequest.success=!1),f.uploadRequest.isLoading=!1},function(e){alert("Hubo un error en el servidor")})}function d(){s.requestHasSent(e.id,f.userCreds.id,f.userCreds.role).then(function(e){e.success?f.userHasSentReq=e.isSent:a.warning(e.msg)},function(e){a.error("Hubo un error en el servidor")})}function l(e,t,s){if(!/https:\/\/www.youtube.com/g.test(t))return void a.warning("Debe subir una URL de Youtube");null===e||void 0===e?n.uploadVideo({teamId:f.userCreds.teamId,type:s,ytUrl:t}).then(function(e){e.success?(a.success(e.msg),"DEMO"==s?(f.teamData.youtube_videos[0].youtube_url=t,f.teamData.youtube_videos[0].id=e.videoId):(f.teamData.youtube_videos[1].youtube_url=t,f.teamData.youtube_videos[1].id=e.videoId)):a.warning(e.msg)},function(e){a.error("Hubo un error al subir su video")}):n.updateVideo({type:s,ytUrl:t},e).then(function(e){e.success?(a.success(e.msg),"DEMO"==s?f.teamData.youtube_videos[0].youtube_url=t:f.teamData.youtube_videos[1].youtube_url=t):a.warning(e.msg)},function(e){a.error("Hubo un error al subir su video")})}function g(){if(f.appDoc.state=!0,angular.equals(f.appDoc.file,{})||null===f.appDoc.file)return void a.warning("Debe subir un archivo");n.uploadAppDoc({appDoc:f.appDoc.file,teamId:f.userCreds.teamId}).then(function(e){f.appDoc.state=!1,e.success?(a.success(e.msg),f.teamData.app_doc=e.docName,f.appDoc.file=null):a.warning(e.msg)},function(e){f.appDoc.state=!1,a.error("Hubo un error al subir su documento")})}function m(){if(angular.equals(f.appApk.file,{})||null===f.appApk.file)return void a.warning("Debe subir un archivo");f.appApk.state=!0,n.uploadAppApk({appApk:f.appApk.file,teamId:f.userCreds.teamId}).then(function(e){e.success?(f.appApk={file:null,progress:0,state:!1},f.teamData.app_apk=e.docName,a.success(e.msg)):a.warning(e.msg)},function(e){a.error("Hubo un error al subir su documento"),f.appApk={file:null,progress:0,state:!1}},function(e){f.appApk.progress=parseInt(100*e.loaded/e.total)})}var f=this;f.teamData={},f.userCreds=i.getSession(),f.hasTeam=f.userCreds.hasTeam,f.isMTeam={state:e.id==f.userCreds.teamId,isLeader:f.userCreds.isLeader,uid:f.userCreds.id},f.teamImg={id:e.id,newImg:null},f.uploadImg={isLoading:!1},f.uploadRequest={isLoading:!1,msg:"",success:!0},f.youtubeUrls={demo:{url:"",type:"DEMO"},team:{url:"",type:"EQUIPO"}},f.appDoc={file:null,state:!1},f.appApk={file:null,progress:0,state:!1},f.userHasSentReq=!1,f.getTeamData=r,f.inviteToTeam=o,f.updateTeamImg=u,f.joinTeam=c,f.requestHasSent=d,f.uploadVideo=l,f.uploadAppDoc=g,f.uploadAppApk=m,r(e.id),1!=f.userCreds.role&&2!=f.userCreds.role||f.requestHasSent()}angular.module("heroesDigitalesApp").controller("TeamProfileCtrl",["$stateParams","$timeout","User","Team","Auth","LxNotificationService",e])}(),function(){"use strict";function e(e){function t(){e.getTeams().then(function(e){e.success?(n.isLoading=!1,n.teams=e.teams):(alert(e.msg),n.isLoading=!1)},function(e){n.isLoading=!1,alert("Hubo un error al obtener a los equipos, inténtelo nuevamente")})}function s(e,t){var s=n.filters[e].indexOf(t);-1==s?n.filters[e].push(t):n.filters[e].splice(s,1)}var n=this;n.teams=[],n.filters={cities:["La Paz","El Alto"],divisions:["Junior (de 10 a 14 años)","Senior (de 15 a 18 años)"],categories:["Educación"],teamThat:{requestMembers:!0,requestMentors:!0}},n.getTeams=t,n.updateFilter=s,n.isLoading=!0,t()}angular.module("heroesDigitalesApp").controller("TeamsCtrl",["Team",e])}(),function(){"use strict";function e(e,t,s,n,i,a){function r(){t.getCities().then(function(e){e.success&&(d.cities=e.cities)},function(e){})}function o(){s.getCategories().then(function(e){e.success&&(d.categories=e.categories)},function(e){})}function u(){n.getDivisions().then(function(e){e.success&&(d.divisions=e.divisions)},function(e){})}function c(){if(0==d.dataRegister.cityId||0==d.dataRegister.divisionId)return d.isNotRegistered.state=!0,void(d.isNotRegistered.msg="Todos los campos son requeridos");d.isNotRegistered.state=!1,d.isNotRegistered.isLoading=!0,i.registerTeam(d.dataRegister).then(function(t){t.success?(a.setHasTeam(!0),a.setIsLeader(!0),a.setTeamId(t.team_id),e.go("user")):(d.isNotRegistered.state=!0,d.isNotRegistered.isLoading=!1,d.isNotRegistered.msg=t.msg)},function(e){d.isNotRegistered.state=!0,d.isNotRegistered.isLoading=!1,d.isNotRegistered.msg=data.msg})}var d=this;d.getCities=r,d.getDivisions=u,d.getCategories=o,d.sendRegistration=c,d.isNotRegistered={state:!1,msg:"",isLoading:!1},d.categoryDesc="",d.dataRegister={idLeader:a.getSession().id,teamName:"",cityId:0,divisionId:0,img:{}},d.cities=[],d.divisions=[],d.categories=[],r(),o(),u()}angular.module("heroesDigitalesApp").controller("CreateTeamCtrl",["$state","City","Category","Division","Team","Auth",e])}(),function(){"use strict";function e(e,t,s,n,i,a,r,o,u){function c(){o.getStages().then(function(e){e.success?b.stages=e.stages:alert(e.msg)},function(e){})}function d(){i.getInfo(b.userCreds.id).then(function(e){if(e.success){if(b.isUserDataLoaded=!0,b.userData=e.user,1!=b.userCreds.role&&2!=b.userCreds.role||null!=e.user.teacheable||$("#teacheableModal").modal({display:"show",backdrop:"static",keyboard:!1}),b.userData.invitations=!angular.equals(e.user.invitations,[])&&e.user.invitations,b.userData.has_team)for(var t=0;t<b.userData.team.members.length;t++)b.userData.team.members[t].is_student?b.students.push(b.userData.team.members[t]):(b.menthors.push(b.userData.team.members[t]),b.userData.team.has_menthor=!0)}else alert(e.msg)},function(e){u.error("Hubo un error al descargar sus datos, revise su conexión a internet")})}function l(e,t){t?r.confirmRequestToJoin({reqId:e,accept:t}).then(function(e){e.success?(u.success("El participante fue adicionado a tu equipo"),b.students=[],b.mentors=[],b.getUserData()):u.warning(e.msg)},function(e){u.error("Hubo un error en el servidor")}):u.confirm("Rechazar solicitud","Estas seguro que deseas rechazar la solicitud del participante?",{cancel:"Cancelar",ok:"Si, quiero hacerlo"},function(s){s&&r.confirmRequestToJoin({reqId:e,accept:t}).then(function(e){e.success?(u.success("La solicitud fue eliminada"),b.getUserData()):u.warning(e.msg)},function(e){u.error("Hubo un error en el servidor")})})}function g(e,t,s){s?r.confirmInvitationFromTeam({invitationId:e,teamId:t,accept:s}).then(function(e){e.success?(u.success("Aceptaste la invitación del equipo"),b.getUserData(),a.setHasTeam(!0),a.setIsLeader(!1),a.setTeamId(e.team_id)):u.warning(e.msg)},function(e){u.error("Hubo un error en el servidor")}):u.confirm("Rechazar invitación","Estas seguro que deseas rechazar la invitación del equipo?",{cancel:"Cancelar",ok:"Si, quiero hacerlo"},function(n){n&&r.confirmInvitationFromTeam({invitationId:e,teamId:t,accept:s}).then(function(e){e.success?(u.success("La invitación fue eliminada"),a.setTeamId(t),a.setIsLeader(!1),a.setHasTeam(!0),b.userCreds=a.getSession(),b.getUserData()):u.warning(e.msg)},function(e){u.error("Hubo un error en el servidor")})})}function m(e,t){var s=void 0==t?null:t;u.confirm("Eliminar membresía","Estas seguro que deseas eliminar la membresía del participante?",{cancel:"Cancelar",ok:"Si, quiero hacerlo"},function(t){t&&r.deleteMembership(e,s).then(function(e){e.success?(b.students=[],b.mentors=[],b.getUserData(),u.success("El miembro fue eliminado")):u.warning(e.msg)},function(e){u.error("Hubo un error en el servidor")})})}function f(e){b.emailInvitation.teamId=b.userData.team.id,b.emailInvitation.type=e,b.emailInvitation.leaderId=b.userData.id;var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return""!=b.emailInvitation.mail&&t.test(b.emailInvitation.mail)?"mentor"==e&&b.userData.team.is_full_mentors?(b.emailInvitation.state.success=!0,void(b.emailInvitation.state.msg="Tú equipo ya tiene 2 mentores")):"student"==e&&b.userData.team.is_full_students?(b.emailInvitation.state.success=!0,void(b.emailInvitation.state.msg="Tú equipo ya tiene 4 estudiantes")):(b.emailInvitation.state.isLoading=!0,void i.sendEmailInvitation(b.emailInvitation).then(function(e){b.emailInvitation.state.isLoading=!1,e.success?($("#mailStudent").modal("hide"),$("#mailMentor").modal("hide"),b.emailInvitation.mail="",b.emailInvitation.state.success=!1,$("#invitationSend").modal("show"),b.sended.title="Invitación Enviada!",b.sended.msg=e.msg):(b.emailInvitation.state.success=!0,b.emailInvitation.state.msg=e.msg)},function(e){b.emailInvitation.state.msg="Hubo un problema al enviar la invitación",b.emailInvitation.state.success=!0,b.emailInvitation.state.isLoading=!1})):(b.emailInvitation.state.success=!0,void(b.emailInvitation.state.msg="Debes ingresar un correo electrónico"))}function p(){b.emailInvitation.state.success=!1,b.emailInvitation.mail=""}function h(e){r.confirmInvitationFromTeam({invitationId:e,accept:!1}).then(function(t){if(t.success){for(var s=0,n=b.userData.team.invitations_sent,i=0;i<n.length;i++)n[i].invitation_id==e&&(s=i);n.splice(s,1),u.success("La invitación fue cancelada")}else u.warning("Hubo un error al cancelar la invitación")},function(e){u.error("Hubo un error en el servidor, revise su conexión a internet")})}function v(){i.createTeachableCreds({id:b.userCreds.id}).then(function(e){e.success?$("#teacheableModal").modal("hide"):u.warning(e.msg)},function(e){u.error("Hubo un error al crear su crendencial, verifique su conexión a internet")})}var b=this;b.userCreds=a.getSession(),b.userData={},b.menthors=[],b.students=[],b.isUserDataLoaded=!1,b.emailInvitation={mail:"",teamId:0,type:"",state:{isLoading:!1,msg:"",success:!1}},b.sended={msg:"",title:""},b.stages=[],b.getUserData=d,b.confirmRequest=l,b.confirmInvitation=g,b.deleteMembership=m,b.sendInvitationEmail=f,b.clearFields=p,b.getStages=c,b.cancelInvitation=h,b.setActiveTeachable=v,d(),c()}angular.module("heroesDigitalesApp").controller("DashboardUserCtrl",["$scope","$window","$timeout","$state","User","Auth","Team","Stage","LxNotificationService",e])}(),function(){"use strict";function e(e,t,s,n,i,a){function r(){t.getInfo(m.userCreds.id).then(function(e){e.success?(m.userData=e.user,m.userData.bio=m.userData.bio?m.userData.bio.name:""):alert(e.msg)},function(e){alert("Hubo un error al realizar los cambios")})}function o(){s.getCities().then(function(e){e.success&&(m.cities=e.cities)},function(e){})}function u(){i.getExpertises().then(function(e){e.success&&(m.expertises=e.expertises)},function(e){})}function c(){a.getSkills().then(function(e){e.success&&(m.skills=e.skills,m.skillsUser=e.skills)},function(e){})}function d(){if(!l(m.userData))return m.updateSuccess.state=!0,void(m.updateSuccess.msg="No puedes dejar los campos con * en vacío");if(1==m.userCreds.role||4==m.userCreds.role)t.updateStudent(m.userData,m.userData.id).then(function(t){t.success?e.go("user.my-profile"):alert("Hubo un error, inténtelo nuevamente")},function(e){alert("Hubo un error en servidor, revise su conexión a internet")});else if(2==m.userCreds.role){var s=m.userData;s.skills=m.skillsUser,t.updateMenthor(s,m.userData.id).then(function(t){t.success?e.go("user.my-profile"):alert("Hubo un error, inténtelo nuevamente")},function(e){alert("Hubo un error en servidor, revise su conexión a internet")})}}function l(e){if(void 0==e.names||void 0==e.lastnames||void 0==e.zone||void 0==e.cellphone)return!1;if(1==e.role_id){if(""==e.student.school||void 0==e.student.school)return!1}else e.role_id;return!0}function g(e){if(e.length>2e3)return void(m.userData.bio=m.userData.bio.substr(0,2e3))}var m=this;m.userCreds=n.getSession(),m.userData={},m.cities=[],m.zones=[],m.skills=[],m.expertises=[],m.skillsUser=[],m.updateSuccess={state:!1,msg:""},m.getUserData=r,m.getCities=o,m.getSkills=c,m.getExpertises=u,m.update=d,m.validateChars=g;var l=l;r(),o(),c(),u()}angular.module("heroesDigitalesApp").controller("EditProfileCtrl",["$state","User","City","Auth","Expertise","Skill",e])}(),function(){"use strict";function e(e,t){function s(){t.logout()}var n=this;n.userCreds=t.getSession(),n.hasMinFields=n.userCreds.minFields,n.logout=s}angular.module("heroesDigitalesApp").controller("HeaderUserCtrl",["User","Auth",e])}(),function(){"use strict";function e(e,t,s){function n(){t.acceptHonorCode({uid:i.userCreds.id,name:i.signature.name}).then(function(t){t.success?e.go("user"):alert("Hubo un error inténtelo nuevamente")},function(e){alert("Hubo un error en el servidor")})}var i=this;i.userCreds=s.getSession(),i.signature={name:""},i.accept=n}angular.module("heroesDigitalesApp").controller("HonorCodeCtrl",["$state","User","Auth",e])}(),function(){"use strict";function e(e,t){function s(){e.getInfo(i.userCreds.id).then(function(e){e.success?i.userData=e.user:alert(e.msg)},function(e){})}function n(){e.updateImage({img:i.userImg.newImg},i.userCreds.id).then(function(e){e.success&&(i.userImg.newImg=null,s())},function(e){})}var i=this;i.userCreds=t.getSession(),i.userData={},i.userImg={newImg:null},i.getUserData=s,i.updateImg=n,s()}angular.module("heroesDigitalesApp").controller("MyProfileCtrl",["User","Auth",e])}(),function(){"use strict";function e(e,t,s,n,i){function a(){o.sended.isLoading=!0,s.acceptParentsAuth({uid:o.userCreds.id,signature:o.parents.signature,email:o.parents.email}).then(function(e){$("#parentsModal").modal("show"),o.sended.isLoading=!1,o.sended.title=e.title,e.success?(o.parents={signature:"",email:""},o.sended.msg=e.msg,o.sended.success=!0):(o.sended.msg=e.msg,o.sended.success=!1)},function(e){i.error("Hubo un error en el servidor, revise su conexión a internet")})}function r(s){s&&t(function(){e.go("user")},500)}var o=this;o.userCreds=n.getSession(),o.parents={signature:"",email:""},o.sended={isLoading:!1,msg:"",title:"",success:!1},o.accept=a,o.redirect=r}angular.module("heroesDigitalesApp").controller("ParentsAuthCtrl",["$state","$timeout","User","Auth","LxNotificationService",e])}();